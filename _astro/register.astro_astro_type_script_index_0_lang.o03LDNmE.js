import{u as P,j as e}from"./useTranslations.3K2L2pz4.js";import{r as o}from"./index.BpawKBta.js";import{A as X,T as _}from"./TitleUpdater.CM5_3pk8.js";import{u as I,t as $,a as z}from"./validation.BVj0pO-N.js";import{u as B}from"./useAuthStore.DRmIAJ9f.js";import{B as G}from"./Button.C6c-rj7E.js";import{I as c}from"./Input.BD0f6wsr.js";import{A as O,L as U}from"./Alert.qBavEDjr.js";import{F as v}from"./EyeSlashIcon.Cr4r18Zw.js";import{F as N}from"./EyeIcon.Db-6UeUT.js";import{S as Z}from"./SocialAuth.CcOFDWG_.js";import{a as D}from"./client.Cc-aT41I.js";import"./utils.DL5Rb5yz.js";import"./auth.service.DX0mUkDK.js";import"./index.6MJZYV4G.js";const H=({onSuccess:m,onSwitchToLogin:d,globalError:h,onClearGlobalError:g,onSetGlobalError:x})=>{const[l,p]=o.useState(!1),[n,u]=o.useState(!1),{register:S,isLoading:j,error:y,clearError:f}=B(),r=P(),{register:i,handleSubmit:C,formState:{errors:t,isValid:E},setError:F,watch:A}=I({resolver:$(z),mode:"onChange"}),w=A("password");o.useEffect(()=>{y&&(x(y),f())},[y,x,f]);const L=async a=>{f();try{await S(a),m?.()}catch(s){s instanceof Error&&s.message.includes("email_already_exists")&&F("email",{message:r.user?.email_already_exists||"Email already exists"})}},b=(a=>{if(!a)return{strength:0,label:"",color:""};let s=0;a.length>=8&&s++,/[a-z]/.test(a)&&s++,/[A-Z]/.test(a)&&s++,/\d/.test(a)&&s++,/[^A-Za-z0-9]/.test(a)&&s++;const R=["Très faible","Faible","Moyenne","Forte","Très forte"],T=["bg-red-500","bg-orange-500","bg-yellow-500","bg-blue-500","bg-green-500"];return{strength:s,label:R[s-1]||"",color:T[s-1]||""}})(w||"");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r.register||"Create account"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:r.register_subtitle||"Create your account to get started"})]}),h&&e.jsx(O,{variant:"destructive",onClose:g,children:h}),e.jsxs("form",{onSubmit:C(L),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"firstname",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r.firstName||"First name"}),e.jsx(c,{id:"firstname",type:"text",autoComplete:"given-name",placeholder:r.firstNamePlaceholder||"John",error:t.firstname?.message,...i("firstname")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lastname",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r.lastName||"Last name"}),e.jsx(c,{id:"lastname",type:"text",autoComplete:"family-name",placeholder:r.lastNamePlaceholder||"Doe",error:t.lastname?.message,...i("lastname")})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r.email||"Email"}),e.jsx(c,{id:"email",type:"email",autoComplete:"email",placeholder:r.emailPlaceholder||"your@email.com",error:t.email?.message,...i("email")})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r.phone||"Phone"," ",e.jsxs("span",{className:"text-gray-400",children:["(",r.optional||"optional",")"]})]}),e.jsx(c,{id:"phone",type:"tel",autoComplete:"tel",placeholder:r.phonePlaceholder||"+226 XX XX XX XX",error:t.phone?.message,...i("phone")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r.password||"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{id:"password",type:l?"text":"password",autoComplete:"new-password",placeholder:r.passwordPlaceholder||"Your password",error:t.password?.message,className:"pr-10",...i("password")}),e.jsx("button",{type:"button",className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",onClick:()=>p(!l),"aria-label":l?r.hidePassword:r.showPassword,children:l?e.jsx(v,{className:"h-5 w-5"}):e.jsx(N,{className:"h-5 w-5"})})]}),w&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full dark:bg-gray-700",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${b.color}`,style:{width:`${b.strength/5*100}%`}})}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:b.label})]})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r.confirmPassword||"Confirm password"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{id:"confirmPassword",type:n?"text":"password",autoComplete:"new-password",placeholder:r.confirmPasswordPlaceholder||"Confirm your password",error:t.confirmPassword?.message,className:"pr-10",...i("confirmPassword")}),e.jsx("button",{type:"button",className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",onClick:()=>u(!n),"aria-label":n?r.hidePassword:r.showPassword,children:n?e.jsx(v,{className:"h-5 w-5"}):e.jsx(N,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("input",{id:"terms",type:"checkbox",className:"h-4 w-4 mt-1 rounded border-gray-300 text-primary-600 focus:ring-primary-500 dark:border-gray-600 dark:bg-gray-700",...i("terms")}),e.jsxs("label",{htmlFor:"terms",className:"ml-3 block text-sm text-gray-900 dark:text-gray-300",children:[r.terms||"I accept the"," ",e.jsx("a",{href:"https://doc-hosting.flycricket.io/la-cause-rurale-terms-of-use/78422ce1-34a2-4405-80b7-512c558512f7/terms",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-500 dark:text-primary-400 dark:hover:text-primary-300",children:r.termsLink||"terms of service"})," ",r.and||"and"," ",e.jsx("a",{href:"https://doc-hosting.flycricket.io/la-cause-rurale-privacy-policy/d328883c-83a8-477a-a5fc-1a27aec79002/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-500 dark:text-primary-400 dark:hover:text-primary-300",children:r.privacyLink||"privacy policy"})]})]}),t.terms&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:t.terms.message})]}),e.jsx(G,{type:"submit",disabled:!E,loading:j,className:"w-full",children:j?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(U,{size:"sm"}),e.jsx("span",{className:"ml-2",children:r.registering||"Creating account..."})]}):r.register||"Create account"}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.noRegister||"Already have an account?"," ",e.jsx("button",{type:"button",onClick:d,className:"cursor-pointer font-medium text-primary-600 hover:text-primary-500 dark:text-primary-400 dark:hover:text-primary-300",children:r.loginHere||"Sign in here"})]})})]})]})},J=()=>{const[m,d]=o.useState(null),h=P(),g=()=>{window.location.href="/auth/verify-email"},x=()=>{window.location.href="/auth/login"},l=u=>{d(u)},p=()=>{d(null)},n=()=>{console.log("OAuth registration successful, redirecting to dashboard...")};return e.jsx(X,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(H,{onSuccess:g,onSwitchToLogin:x,globalError:m,onClearGlobalError:p,onSetGlobalError:l}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400",children:h.orContinueWith||"Ou continuer avec"})})]}),e.jsx(Z,{mode:"register",onError:l,onSuccess:n})]})})},k=document.getElementById("register-root");k&&D.createRoot(k).render(o.createElement(o.Fragment,null,o.createElement(_,{titleKey:"registerPageTitle"}),o.createElement(J)));
