import{u as p,j as e}from"./useTranslations.3K2L2pz4.js";import{r}from"./index.BpawKBta.js";import{A as j,T as w}from"./TitleUpdater.B2nVOQO0.js";import{a as _}from"./auth.service.8-EAQZcQ.js";import{B as m}from"./Button.C6c-rj7E.js";import{L as f,A as b}from"./Alert.qBavEDjr.js";import{F as k}from"./CheckCircleIcon.Bt8hlw3h.js";import{a as E}from"./client.Cc-aT41I.js";import"./utils.DL5Rb5yz.js";import"./index.6MJZYV4G.js";function N({title:i,titleId:s,...a},l){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:l,"aria-labelledby":s},a),i?r.createElement("title",{id:s},i):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const V=r.forwardRef(N),R=({token:i})=>{const[s,a]=r.useState("loading"),[l,n]=r.useState(null),[c,v]=r.useState(""),t=p();r.useEffect(()=>{(async()=>{const h=i||(typeof window<"u"?new URLSearchParams(window.location.search).get("token"):null);if(!h){a("error"),n(t.auth?.verify_email_error||"Token de vérification manquant");return}try{await _.verifyEmail(h),a("success")}catch(d){console.error("Email verification failed:",d),a("error"),n(d instanceof Error?d.message:t.auth?.verify_email_error||"La vérification a échoué")}})()},[i,t.auth]);const g=async()=>{if(!c){n(t.validation?.email_required||"Veuillez entrer votre adresse email");return}a("resending"),n(null);try{setTimeout(()=>{a("success")},2e3)}catch(o){a("error"),n(o instanceof Error?o.message:t.auth?.resend_verification_failed||"Échec de l'envoi de l'email de vérification")}},u=()=>{window.location.href="/auth/login"},y=()=>{switch(s){case"loading":return e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx(f,{size:"lg"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:t.auth?.verify_email_subtitle||"Vérification de votre adresse email en cours"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.auth?.please_wait||"Veuillez patienter..."})]})]});case"success":return e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 dark:bg-green-900/20",children:e.jsx(k,{className:"h-8 w-8 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:t.auth?.verify_email_success||"Email vérifié avec succès !"}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[t.auth?.account_activated_message||"Votre compte est maintenant activé. Vous pouvez vous connecter."," "]})]}),e.jsx(m,{onClick:u,className:"w-full",children:t.auth?.go_to_login||"Aller à la connexion"})]});case"error":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 dark:bg-red-900/20",children:e.jsx(V,{className:"h-8 w-8 text-red-600 dark:text-red-400"})}),e.jsx("h3",{className:"mt-4 text-lg font-semibold text-gray-900 dark:text-white",children:t.auth?.verify_email_error||"Vérification échouée"})]}),l&&e.jsx(b,{variant:"destructive",children:l}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:t.email||"Email"}),e.jsx("input",{type:"email",id:"email",value:c,onChange:o=>v(o.target.value),placeholder:t.emailPlaceholder||"votre@email.com",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent dark:border-gray-600 dark:bg-gray-700 dark:text-white"})]}),e.jsx(m,{onClick:g,disabled:!c.trim(),className:"w-full",children:t.auth?.resend_verification||"Renvoyer le lien de vérification"}),e.jsx(m,{variant:"outline",onClick:u,className:"w-full",children:t.auth?.back_to_login||"Retour à la connexion"})]})]});case"resending":return e.jsxs("div",{className:"text-center space-y-6",children:[e.jsx(f,{size:"lg"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:t.auth?.sending||"Envoi en cours..."}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.auth?.sending_new_verification||"Envoi d'un nouveau lien de vérification..."})]})]});default:return null}};return e.jsx(j,{title:t.auth?.verify_email_title||"Vérification de l'email",subtitle:s==="success"?t.auth?.account_activated||"Compte activé avec succès":s==="error"?t.auth?.verification_problem||"Problème de vérification":t.auth?.verification_in_progress||"Vérification en cours...",children:y()})},x=document.getElementById("verify-email-root");x&&E.createRoot(x).render(r.createElement(r.Fragment,null,r.createElement(w,{titleKey:"verifyEmailPageTitle"}),r.createElement(R)));
