import{u as k,j as e}from"./useTranslations.3K2L2pz4.js";import{r as m}from"./index.BpawKBta.js";import{A as X}from"./AuthLayout.DZtxryXY.js";import{u as T,t as z,a as I}from"./validation.BVj0pO-N.js";import{u as $}from"./useAuthStore.BcfiTys1.js";import{B}from"./Button.BrsDPvoC.js";import{I as c}from"./Input.DshfeKVD.js";import{A as G,L as Z}from"./Alert.B0cLzLLj.js";import{F as w}from"./EyeSlashIcon.Cr4r18Zw.js";import{F as v}from"./EyeIcon.Db-6UeUT.js";import{S as D}from"./SocialAuth.DN6d_77d.js";import{a as H}from"./client.Cc-aT41I.js";import"./utils.DGTNTuzh.js";import"./auth.service.DyqDjy0G.js";import"./index.BP3dD5_l.js";const J=({onSuccess:d,onSwitchToLogin:x,globalError:i,onClearGlobalError:g,onSetGlobalError:h})=>{const[o,p]=m.useState(!1),[n,P]=m.useState(!1),{register:S,isLoading:b,error:u,clearError:y}=$(),r=k(),{register:l,handleSubmit:C,formState:{errors:s,isValid:E},setError:F,watch:A}=T({resolver:z(I),mode:"onChange"}),j=A("password");m.useEffect(()=>{u&&(h(u),y())},[u,h,y]);const L=async a=>{y();try{await S(a),d?.()}catch(t){t instanceof Error&&t.message.includes("email_already_exists")&&F("email",{message:r.user?.email_already_exists||"Email already exists"})}},f=(a=>{if(!a)return{strength:0,label:"",color:""};let t=0;a.length>=8&&t++,/[a-z]/.test(a)&&t++,/[A-Z]/.test(a)&&t++,/\d/.test(a)&&t++,/[^A-Za-z0-9]/.test(a)&&t++;const R=["Très faible","Faible","Moyenne","Forte","Très forte"],_=["bg-red-500","bg-orange-500","bg-yellow-500","bg-blue-500","bg-green-500"];return{strength:t,label:R[t-1]||"",color:_[t-1]||""}})(j||"");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r.register||"Create account"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:r.register_subtitle||"Create your account to get started"})]}),i&&e.jsx(G,{variant:"destructive",onClose:g,children:i}),e.jsxs("form",{onSubmit:C(L),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"firstname",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r.firstName||"First name"}),e.jsx(c,{id:"firstname",type:"text",autoComplete:"given-name",placeholder:r.firstNamePlaceholder||"John",error:s.firstname?.message,...l("firstname")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"lastname",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r.lastName||"Last name"}),e.jsx(c,{id:"lastname",type:"text",autoComplete:"family-name",placeholder:r.lastNamePlaceholder||"Doe",error:s.lastname?.message,...l("lastname")})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r.email||"Email"}),e.jsx(c,{id:"email",type:"email",autoComplete:"email",placeholder:r.emailPlaceholder||"your@email.com",error:s.email?.message,...l("email")})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:[r.phone||"Phone"," ",e.jsxs("span",{className:"text-gray-400",children:["(",r.optional||"optional",")"]})]}),e.jsx(c,{id:"phone",type:"tel",autoComplete:"tel",placeholder:r.phonePlaceholder||"+226 XX XX XX XX",error:s.phone?.message,...l("phone")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r.password||"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{id:"password",type:o?"text":"password",autoComplete:"new-password",placeholder:r.passwordPlaceholder||"Your password",error:s.password?.message,className:"pr-10",...l("password")}),e.jsx("button",{type:"button",className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",onClick:()=>p(!o),"aria-label":o?r.hidePassword:r.showPassword,children:o?e.jsx(w,{className:"h-5 w-5"}):e.jsx(v,{className:"h-5 w-5"})})]}),j&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full dark:bg-gray-700",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${f.color}`,style:{width:`${f.strength/5*100}%`}})}),e.jsx("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:f.label})]})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:r.confirmPassword||"Confirm password"}),e.jsxs("div",{className:"relative",children:[e.jsx(c,{id:"confirmPassword",type:n?"text":"password",autoComplete:"new-password",placeholder:r.confirmPasswordPlaceholder||"Confirm your password",error:s.confirmPassword?.message,className:"pr-10",...l("confirmPassword")}),e.jsx("button",{type:"button",className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",onClick:()=>P(!n),"aria-label":n?r.hidePassword:r.showPassword,children:n?e.jsx(w,{className:"h-5 w-5"}):e.jsx(v,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx("input",{id:"terms",type:"checkbox",className:"h-4 w-4 mt-1 rounded border-gray-300 text-primary-600 focus:ring-primary-500 dark:border-gray-600 dark:bg-gray-700",...l("terms")}),e.jsxs("label",{htmlFor:"terms",className:"ml-3 block text-sm text-gray-900 dark:text-gray-300",children:[r.terms||"I accept the"," ",e.jsx("a",{href:"https://doc-hosting.flycricket.io/la-cause-rurale-terms-of-use/78422ce1-34a2-4405-80b7-512c558512f7/terms",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-500 dark:text-primary-400 dark:hover:text-primary-300",children:r.termsLink||"terms of service"})," ",r.and||"and"," ",e.jsx("a",{href:"https://doc-hosting.flycricket.io/la-cause-rurale-privacy-policy/d328883c-83a8-477a-a5fc-1a27aec79002/privacy",target:"_blank",rel:"noopener noreferrer",className:"text-primary-600 hover:text-primary-500 dark:text-primary-400 dark:hover:text-primary-300",children:r.privacyLink||"privacy policy"})]})]}),s.terms&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:s.terms.message})]}),e.jsx(B,{type:"submit",disabled:!E,loading:b,className:"w-full",children:b?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(Z,{size:"sm"}),e.jsx("span",{className:"ml-2",children:r.registering||"Creating account..."})]}):r.register||"Create account"}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.noRegister||"Already have an account?"," ",e.jsx("button",{type:"button",onClick:x,className:"cursor-pointer font-medium text-primary-600 hover:text-primary-500 dark:text-primary-400 dark:hover:text-primary-300",children:r.loginHere||"Sign in here"})]})})]})]})},M=()=>{const[d,x]=m.useState(null),i=k(),g=()=>{window.location.href="/auth/verify-email"},h=()=>{window.location.href="/auth/login"},o=n=>{x(n)},p=()=>{x(null)};return e.jsx(X,{title:i.auth?.register_title||"Créer votre compte",subtitle:i.auth?.register_subtitle||"Rejoignez-nous pour surveiller l'environnement",children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(J,{onSuccess:g,onSwitchToLogin:h,globalError:d,onClearGlobalError:p,onSetGlobalError:o}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400",children:i.orContinueWith||"Ou continuer avec"})})]}),e.jsx(D,{mode:"register",onError:o})]})})},N=document.getElementById("register-root");N&&H.createRoot(N).render(m.createElement(M));
