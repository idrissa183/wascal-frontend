import{u as b,j as e}from"./useTranslations.3K2L2pz4.js";import{r as t}from"./index.BpawKBta.js";import{A as k,T as E}from"./TitleUpdater.CM5_3pk8.js";import{u as F,t as P,l as A}from"./validation.BVj0pO-N.js";import{u as C}from"./useAuthStore.DRmIAJ9f.js";import{B as L}from"./Button.C6c-rj7E.js";import{I as f}from"./Input.BD0f6wsr.js";import{A as R,L as T}from"./Alert.qBavEDjr.js";import{F as I}from"./EyeSlashIcon.Cr4r18Zw.js";import{F as _}from"./EyeIcon.Db-6UeUT.js";import{S as B}from"./SocialAuth.CcOFDWG_.js";import{a as O}from"./client.Cc-aT41I.js";import"./utils.DL5Rb5yz.js";import"./auth.service.DX0mUkDK.js";import"./index.6MJZYV4G.js";const G=({onSuccess:c,onSwitchToRegister:a,globalError:o,onClearGlobalError:i,onSetGlobalError:l})=>{const[s,m]=t.useState(!1),{login:d,isLoading:n,error:x,clearError:u}=C(),r=b(),{register:h,handleSubmit:w,formState:{errors:g,isValid:v},setError:p}=F({resolver:P(A),mode:"onChange"});t.useEffect(()=>{x&&(l(x),u())},[x,l,u]);const N=async S=>{i();try{await d(S),setTimeout(()=>{window.location.href="/dashboard"},100)}catch(y){y instanceof Error&&y.message.includes("invalid_credentials")&&(p("email",{message:r.auth?.invalid_credentials||"Invalid credentials"}),p("password",{message:r.auth?.invalid_credentials||"Invalid credentials"}))}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r.auth?.login||"Sign in"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:r.auth?.login_subtitle||"Sign in to your account"})]}),o&&e.jsx(R,{variant:"destructive",onClose:i,children:o}),e.jsxs("form",{onSubmit:w(N),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"mb-1 block text-sm font-medium text-gray-700 dark:text-gray-300",children:r.email||"Email"}),e.jsx(f,{id:"email",type:"email",autoComplete:"email",placeholder:r.emailPlaceholder||"your@email.com",error:g.email?.message,...h("email")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:r.password||"Password"}),e.jsx("div",{className:"mt-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(f,{id:"password",type:s?"text":"password",autoComplete:"current-password",placeholder:r.passwordPlaceholder||"Your password",error:g.password?.message,className:"pr-10",...h("password")}),e.jsx("button",{type:"button",className:"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",onClick:()=>m(!s),"aria-label":s?r.hidePassword:r.showPassword,children:s?e.jsx(I,{className:"h-5 w-5"}):e.jsx(_,{className:"h-5 w-5"})})]})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"remember-me",type:"checkbox",className:"h-4 w-4 rounded border-gray-300 text-primary-600 focus:ring-primary-500 dark:border-gray-600 dark:bg-gray-700",...h("rememberMe")}),e.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-gray-900 dark:text-gray-300",children:r.rememberMe||"Remember me"})]}),e.jsx("div",{className:"text-sm",children:e.jsx("a",{href:"/auth/forgot-password",className:"font-medium text-primary-600 hover:text-primary-500 dark:text-primary-400 dark:hover:text-primary-300",children:r.forgotPassword||"Forgot password?"})})]}),e.jsx(L,{type:"submit",disabled:!v,loading:n,className:"w-full",children:n?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(T,{size:"sm"}),e.jsx("span",{className:"ml-2",children:r.loggingIn||"Signing in..."})]}):r.login||"Sign in"}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[r.noAccount||"Don't have an account?"," ",e.jsx("button",{type:"button",onClick:a,className:"cursor-pointer font-medium text-primary-600 hover:text-primary-500 dark:text-primary-400 dark:hover:text-primary-300",children:r.registerHere||"Sign up here"})]})})]})]})},M=()=>{const[c,a]=t.useState(null),o=b(),i=()=>{window.location.href="/dashboard"},l=()=>{window.location.href="/auth/register"},s=n=>{a(n)},m=()=>{a(null)},d=()=>{console.log("OAuth login successful, redirecting to dashboard...")};return e.jsx(k,{children:e.jsxs("div",{className:"space-y-6",children:[e.jsx(G,{onSuccess:i,onSwitchToRegister:l,globalError:c,onClearGlobalError:m,onSetGlobalError:s}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400",children:o.orContinueWith||"Ou continuer avec"})})]}),e.jsx(B,{mode:"login",onError:s,onSuccess:d})]})})},j=document.getElementById("login-root");j&&O.createRoot(j).render(t.createElement(t.Fragment,null,t.createElement(E,{titleKey:"loginPageTitle"}),t.createElement(M)));
